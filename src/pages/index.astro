---
import Layout from '../layouts/Page.astro';
import Container from '../components/containers/Container.astro';
import BlogPostsList from '../components/post/BlogPostsList.astro';
import { getPosts } from '../libs/post';
import Reveal from '../components/Reveal.astro';
import SceneController from '../components/ui/SceneController/SceneController.astro';

const seo = {
	title: 'cloud-np',
	description: 'A simple blog focused on provided the best',
};

const allPosts = await getPosts(undefined);
const posts = allPosts.filter((post) => !post.personal);
---

<Layout seo={seo}>
	<Reveal />
	<SceneController />
	<Container>
		<section class="home-hero-text__container">
			<div class="moon"></div>
			<div class="moon moonRight"></div>
			<div class="m-auto mb-40">
				<div class="justify-center flex mb-10 overflow-hidden">
					<h1 class="reveal-text">Hi</h1>
					<h1 class="reveal-text">there!</h1>
					<h1 class="reveal-text">I'm</h1>
					<h1 class="reveal-text">Nick.</h1>
				</div>
				<div class="overflow-hidden">
					<p class="main-text">
						From dawn to dusk, I'm a software sorcerer, casting
						spells to solve intricate puzzles. I find solace in
						exploring the digital world. Besides that, I enjoy
						freediving, skiing, and playing football.
					</p>
				</div>
			</div>
			<h4 class="projects-title fade-in">Latest Posts</h4>
			<BlogPostsList class="latest-projects-container" posts={posts} />
		</section>
	</Container>
</Layout>

<script>
	import gsap from 'gsap';

	function init(delay: number = 0) {
		gsap.to('.reveal-text', {
			duration: 0.8,
			y: 0,
			stagger: 0.2,
			delay: delay,
			ease: 'power2.out',
		});
		gsap.to('.main-text', {
			duration: 0.8,
			y: 0,
			delay: delay + 0.6,
			ease: 'power2.out',
		});
	}
	init(3.7);
	document.addEventListener('astro:after-swap', () => init());
</script>

<style>
	/* Mirror effect */
	/* .home-hero__welcome-text-cont::after {
		content: "Hi there! I'm Nick.";
		margin-top: max(-26px, -4vw);
		display: flex;
		text-align: center;
		justify-content: center;
		transform: rotateX(180deg);
		background-image: linear-gradient(
			180deg,
			rgba(255, 255, 255, 0) 25%,
			rgba(255, 255, 255, 0.1)
		);
		-webkit-background-clip: text;
		color: transparent;
		white-space: nowrap;
	} */

	.home-hero-text__container {
		padding: 5vh 0;
		display: flex;
		flex-direction: column;
		color: var(--primary);
	}
	/* all .5s cubic-bezier(.76,0,.24,1); */

	.moon {
		width: min(400px, 30vw);
		height: min(400px, 30vw);
		position: absolute;
		top: 10vh;
		left: 5vw;
		border-radius: 50%;
		z-index: -5;
		background: linear-gradient(
			-90deg,
			rgb(26, 26, 26) 10%,
			rgb(15, 15, 15)
		);
		cursor: none;
	}

	.moonRight {
		top: 20vh;
		left: 80vw;
		background: linear-gradient(
			90deg,
			rgb(26, 26, 26) 10%,
			rgb(15, 15, 15)
		);
	}

	.reveal-text {
		transform: translateY(100%);
		margin-right: 13px;
		z-index: -1;
	}

	.no-overflowing {
		overflow: hidden;
		border: 1px solid green;
	}

	h1 {
		text-align: center;
		max-width: 100%;
		font-size: min(3rem, 9vw);
		white-space: nowrap;
	}

	.main-text {
		font-size: 1rem;
		transform: translateY(100%);
		max-width: min(var(--md-container), 600px);
		text-align: center;
		display: flex;
		justify-content: center;
	}

	.waving {
		position: absolute;
		animation: waving-anim 0.5s ease-in-out 5 alternate;
		z-index: -1;
	}

	.waving {
		position: absolute;
		animation: waving-anim 0.5s ease-in-out 5 alternate;
	}

	@keyframes waving-anim {
		from {
			transform: rotate(15deg);
		}
		to {
			transform: rotate(0deg);
		}
	}

	.latest-projects-container {
		padding-top: 2rem;
	}

	.projects-title {
		margin-top: 6rem;
		margin-bottom: 3rem;
	}
</style>
